<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>dwdw</title>

    <!-- Favicon (prevents 404) -->
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <link rel="alternate icon" href="/favicon.ico" />

    <style>
      :root {
        --bg: #0b0b0f;
        --fg: #e8e8ef;
        --muted: #a0a0b2;
        --accent: #22cc88;
        --accent-2: #cc2288;
      }
      html,
      body {
        height: 100%;
        margin: 0;
        background: var(--bg);
        color: var(--fg);
        font: 14px/1.3 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        overflow: hidden;
      }

      #canvas-host {
        position: fixed;
        inset: 0;
        overflow: hidden;
      }

      .toolbar {
        position: fixed;
        inset: 12px 12px auto 12px;
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        align-items: center;
        gap: 12px;
        padding: 8px 10px;
        background: rgba(11,11,15,0.7);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 12px;
        z-index: 100;
        pointer-events: auto;
      }
      .left,
      .center,
      .right {
        display: flex;
        align-items: center;
        gap: 8px;
        min-width: 0;
      }
      .left { justify-content: flex-start; }
      .center { justify-content: center; }
      .right { justify-content: flex-end; }

      button,
      select,
      input[type="range"] {
        color: var(--fg);
        background: #1a1a21;
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 8px;
        padding: 6px 10px;
      }
      button { cursor: pointer; }
      button:disabled,
      select:disabled,
      input:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }
      .hidden { display: none !important; }
      .label { color: var(--muted); white-space: nowrap; }
      .spacer { width: 8px; }
      .grow { flex: 1 1 auto; }
      #seek { width: min(38vw, 520px); }
      #volume { width: 110px; }

      #panels {
        position: fixed;
        right: 0;
        top: 0;
        bottom: 0;
        pointer-events: none;
        z-index: 200;
      }
      #panels .panel {
        pointer-events: auto;
        background: #121219;
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 10px;
        padding: 10px;
        color: var(--fg);
      }
      #panels .panel.hidden { display: none; }

      #screensaver {
        position: fixed;
        inset: 0;
        background: radial-gradient(ellipse at center, rgba(0, 0, 0, 0.35), rgba(0, 0, 0, 0.8));
        opacity: 0;
        pointer-events: none;
        transition: opacity 300ms ease;
        z-index: 150;
      }
      #screensaver.active { opacity: 1; }
    </style>
  </head>
  <body>
    <div id="canvas-host" aria-hidden="true"></div>

    <div class="toolbar" role="region" aria-label="Player controls">
      <div class="left">
        <button id="btn-login" title="Login with Spotify">Login</button>
        <button id="btn-logout" class="hidden" title="Logout">Logout</button>
        <span id="user-label" class="label" aria-live="polite"></span>
        <span class="spacer"></span>
        <label class="label" for="device-picker">Device</label>
        <select id="device-picker" title="Playback device"></select>
      </div>

      <div class="center">
        <button id="btn-prev" title="Previous">⏮</button>
        <button id="btn-play" title="Play">▶</button>
        <button id="btn-pause" class="hidden" title="Pause">⏸</button>
        <button id="btn-next" title="Next">⏭</button>

        <input id="seek" type="range" min="0" max="1000" step="1" value="0" aria-label="Seek" />
        <span id="time-label" class="label">0:00 / 0:00</span>

        <label class="label" for="volume">Vol</label>
        <input id="volume" type="range" min="0" max="100" step="1" value="80" aria-label="Volume" />
      </div>

      <div class="right">
        <label class="label" for="scene-select">Scene</label>
        <select id="scene-select" title="Scene">
          <option value="Auto">Auto</option>
          <option value="Particles">Particles</option>
          <option value="Tunnel">Tunnel</option>
          <option value="Terrain">Terrain</option>
          <option value="Typography">Typography</option>
          <option value="Lyric Lines">Lyric Lines</option>
          <option value="Beat Ball">Beat Ball</option>
          <option value="Flow Field">Flow Field</option>
          <option value="Neon Bars">Neon Bars</option>
          <option value="Stained Glass Voronoi">Stained Glass Voronoi</option>
          <option value="Emo Slashes">Emo Slashes</option>
        </select>

        <button id="btn-crossfade" title="Crossfade visuals">Crossfade</button>
        <button id="btn-vj" title="Open VJ panel">VJ</button>
        <button id="btn-quality" title="Quality settings">Quality</button>
        <button id="btn-accessibility" title="Accessibility">Accessibility</button>
        <button id="btn-record" title="Record visuals">● Rec</button>
        <button id="btn-fullscreen" title="Fullscreen">⛶</button>

        <span id="gpu-label" class="label" title="Graphics device">GPU: —</span>
        <span id="fps-label" class="label" title="Frames per second">FPS: —</span>
      </div>
    </div>

    <div id="panels" aria-live="polite" aria-relevant="additions removals"></div>
    <div id="screensaver" aria-hidden="true"></div>

    <script>
      // Prevent "onSpotifyWebPlaybackSDKReady is not defined" if SDK loads early.
      window.onSpotifyWebPlaybackSDKReady = window.onSpotifyWebPlaybackSDKReady || function() {};
    </script>
    <script src="https://sdk.scdn.co/spotify-player.js" async></script>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>